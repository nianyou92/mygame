<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>年年有愚 FOOL星高照</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        body {
            background-color: #020617;
            background-image: radial-gradient(circle at 20% 30%, rgba(220, 38, 38, 0.1) 0%, transparent 50%),
                              radial-gradient(circle at 80% 70%, rgba(220, 38, 38, 0.1) 0%, transparent 50%);
            position: relative;
            height: 100vh;
            overflow: hidden;
        }
        body::before {
            content: "";
            position: fixed; inset: 0;
            opacity: 0.05;
            pointer-events: none;
            background-image: url("data:image/svg+xml,%3Csvg width='100' height='60' viewBox='0 0 100 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M30 30c0-11 9-20 20-20s20 9 20 20h-5c0-8-7-15-15-15s-15 7-15 15h-5z' fill='%23ffffff' fill-rule='evenodd'/%3E%3C/svg%3E");
            z-index: 0;
        }

        .screen-layer {
            position: fixed;
            inset: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 100;
            background-color: #020617;
        }

        @keyframes char-bounce {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); color: #fbbf24; text-shadow: 0 0 15px #ef4444; }
        }
        .title-char { display: inline-block; animation: char-bounce 2s infinite; }
        .char-1 { animation-delay: 0.1s; } .char-2 { animation-delay: 0.3s; } .char-3 { animation-delay: 0.5s; } .char-4 { animation-delay: 0.7s; }

        /* 统一背光效果：无论什么队名，选中后都强制白色强光 */
        @keyframes select-glow {
            from { box-shadow: 0 0 10px #ffffff; }
            to { box-shadow: 0 0 35px #ffffff, 0 0 10px #fbbf24; }
        }
        .team-btn-selected { 
            border: 4px solid #ffffff !important;
            transform: scale(1.08);
            z-index: 50;
            animation: select-glow 0.8s infinite alternate !important;
        }

        .active-team-glow { 
            animation: team-pulse 1.5s infinite alternate;
            border: 4px solid #ffffff !important;
        }
        @keyframes team-pulse {
            from { box-shadow: 0 0 5px #ffffff; }
            to { box-shadow: 0 0 30px #ffffff; }
        }

        .hidden-word { color: transparent !important; text-shadow: 0 0 40px rgba(0,0,0,1); user-select: none; }
        .peek-word { color: #1e293b !important; text-shadow: none !important; }
        .reveal-answer { color: #dc2626 !important; text-shadow: none !important; transform: scale(1.1); transition: all 0.3s; }
        
        @keyframes pulse-effect { 
            0% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.7); } 
            70% { box-shadow: 0 0 0 20px rgba(239, 68, 68, 0); } 
            100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0); } 
        }
        .pulse-btn { animation: pulse-effect 1.5s infinite; }

        @keyframes emergency-flash { 
            0%, 100% { background-color: transparent; } 
            50% { background-color: rgba(153, 27, 27, 0.7); } 
        }
        .emergency-active { animation: emergency-flash 0.4s infinite; }

        .start-btn { animation: pulse-effect 1.5s infinite; background: radial-gradient(circle, #facc15, #ea580c); }

        * { -webkit-touch-callout: none; -webkit-user-select: none; }
    </style>
</head>
<body class="flex flex-col items-center justify-center min-h-screen text-white font-sans">

    <div id="flash-overlay" class="fixed inset-0 pointer-events-none z-[200]"></div>

    <div id="gate-screen" class="screen-layer p-6 text-center">
        <h1 class="text-6xl font-black mb-12 italic tracking-tighter">
            <span class="text-red-500">年年</span><span class="text-amber-400">有愚</span>
        </h1>
        <button onclick="unlockAndPlay()" class="start-btn w-64 h-64 rounded-full text-slate-900 font-black text-4xl shadow-2xl border-4 border-amber-200">
            柑，你拿
        </button>
        <p class="mt-8 text-amber-200/60 font-bold tracking-widest uppercase">FOOL星高照</p>
    </div>

    <div id="setup-screen" class="screen-layer p-6 hidden">
        <div class="mb-2">
            <span class="title-char char-1 text-5xl font-black">年</span>
            <span class="title-char char-2 text-5xl font-black">年</span>
            <span class="title-char char-3 text-5xl font-black">有</span>
            <span class="title-char char-4 text-5xl font-black">愚</span>
        </div>
        <p class="text-amber-400 font-black tracking-[0.5em] mb-8">FOOL星高照</p>

        <div class="w-full max-w-md space-y-6">
            <div class="grid grid-cols-2 gap-4" id="team-selector"></div>
            <div class="bg-slate-800/90 p-5 rounded-3xl border border-red-900/50 text-center">
                <p class="mb-3 font-bold text-amber-100 italic">目标分数: <span id="target-display" class="text-2xl text-yellow-400">10</span></p>
                <input type="range" min="5" max="15" value="10" id="target-slider" oninput="document.getElementById('target-display').innerText=this.value" class="w-full h-3 bg-slate-700 rounded-lg appearance-none accent-red-500">
            </div>
            <button onclick="confirmTeams()" class="pulse-btn w-full bg-red-600 text-white font-black py-5 rounded-2xl text-3xl shadow-xl border-b-8 border-red-800 active:border-0 active:translate-y-1">开战咯！</button>
        </div>
    </div>

    <div id="game-screen" class="fixed inset-0 flex flex-col items-center justify-center p-4 hidden z-10 bg-transparent">
        <div class="w-full max-w-sm flex justify-between mb-6 gap-3">
            <div id="ui-teamA" class="p-4 rounded-[2rem] text-center w-[48%] transition-all border-4 border-transparent bg-slate-800/90 shadow-lg">
                <p id="labelA" class="text-[14px] font-black opacity-90 truncate">Team A</p>
                <p id="scoreA" class="text-5xl font-black">0</p>
            </div>
            <div id="ui-teamB" class="p-4 rounded-[2rem] text-center w-[48%] transition-all border-4 border-transparent bg-slate-800/90 shadow-lg">
                <p id="labelB" class="text-[14px] font-black opacity-90 truncate">Team B</p>
                <p id="scoreB" class="text-5xl font-black">0</p>
            </div>
        </div>

        <div id="card-area" class="w-full max-w-sm bg-white rounded-[4rem] shadow-[0_20px_50px_rgba(220,38,38,0.4)] p-10 text-center relative h-80 flex flex-col items-center justify-center border-8 border-red-50">
            <div id="timer" class="absolute top-8 text-4xl font-mono text-slate-300 font-black italic">60s</div>
            <div id="word-display" class="text-5xl font-black text-slate-800">READY?</div>
            <div id="hint-text" class="absolute bottom-8 text-[11px] text-slate-400 font-bold opacity-0 transition-opacity">长按屏幕查看谜底</div>
        </div>

        <div class="w-full max-w-sm mt-10 space-y-4">
            <div id="pre-game-controls" class="space-y-4">
                <button id="btn-draw" onclick="drawWord()" class="pulse-btn w-full bg-red-600 text-yellow-300 font-black py-6 rounded-3xl text-3xl shadow-2xl border-b-8 border-red-800 active:border-0 active:translate-y-2">抽 题</button>
                <div id="change-confirm-group" class="hidden space-y-3">
                    <button id="btn-change" onclick="changeWord()" class="w-full bg-slate-800 text-amber-400 font-bold py-4 rounded-2xl border-2 border-slate-700">换题 (剩 2 次)</button>
                    <button onclick="confirmAndStart()" class="w-full bg-emerald-500 text-white font-black py-5 rounded-3xl text-2xl shadow-lg border-b-8 border-emerald-700 active:border-0 active:translate-y-1">开始计时</button>
                </div>
            </div>
            
            <div id="active-game-controls" class="grid grid-cols-2 gap-4 hidden">
                <button onclick="handlePoint()" class="bg-amber-400 text-slate-900 font-black py-6 rounded-3xl shadow-xl text-2xl border-b-8 border-amber-600 active:border-0 active:translate-y-1">+1 答对</button>
                <button onclick="handleSwitch()" class="bg-slate-700 text-white font-bold py-6 rounded-3xl shadow-lg border-b-8 border-slate-900 active:border-0 active:translate-y-1 uppercase text-[16px]">答错/抢答</button>
            </div>
        </div>
    </div>

    <script>
        const allWords = [
// --- 影视与角色 (表演性极强) ---
            "孙悟空", "猪八戒", "哪吒", "白娘子", "林黛玉", "哈利波特", "蜘蛛侠", "蝙蝠侠", "小丑", "灭霸", "奥特曼", "怪兽", "蜡笔小新", "多啦A梦", "海绵宝宝", "皮卡丘", "火影忍者", "黑猫警长", "葫芦娃", "功夫熊猫", "玛丽奥", "芭比娃娃", "蒙娜丽莎",

            // --- 怀旧与童年 (共鸣感强) ---
            "跳飞机", "打弹珠", "老鹰捉小鸡", "丢手绢", "捉迷藏", "跳橡皮筋", "红绿灯", "东南西北", "纸飞机", "吹泡泡", "转笔", "抄作业", "被罚站", "家长会", "红领巾", "校服", "文具盒", "橡皮擦", "自动铅笔",

            // --- 抽象概念与情感 (高难度) ---
            "一见钟情", "白日做梦", "心碎", "忐忑", "嫉妒", "寂寞", "压力山大", "幸福感", "遗憾", "运气", "缘分", "秘密", "背叛", "尴尬", "无语", "傲娇", "腹黑", "佛系", "自恋", "被害幻想", "强迫症", "选择困难",

            // --- 现代生活与科技 ---
            "扫地机器人", "无人机", "VR眼镜", "刷脸支付", "短视频", "直播带货", "元宇宙", "人工智能", "区块链", "验证码", "弹幕", "朋友圈", "点赞", "拉黑", "断网", "没电了", "信号差", "路由器", "投影仪", "电子烟",

            // --- 动作与琐事 (适合比划) ---
            "割草", "挤奶", "缝补", "绣花", "打毛衣", "磨刀", "劈柴", "和面", "包饺子", "撸串", "喝奶茶", "吃柠檬", "晕车", "中暑", "抽筋", "落枕", "磨牙", "梦游", "打呼噜", "剔牙", "翻白眼", "挖鼻孔", "扎马尾", "试衣服", "穿高跟鞋", "系领带",

            // --- 世界名胜与地理 ---
            "金字塔", "埃菲尔铁塔", "比萨斜塔", "自由女神", "长城", "故宫", "兵马俑", "迪士尼", "好莱坞", "南极", "北极", "火山口", "沙漠", "瀑布", "海市蜃楼", "大堡礁", "亚马逊", "百慕大", "外星基地",

            // --- 动物与自然 (更生僻/有趣) ---
            "草泥马", "树懒", "啄木鸟", "萤火虫", "变色龙", "刺猬", "孔雀开屏", "鸵鸟", "袋鼠", "河马", "大象", "长颈鹿", "海马", "水母", "食人鱼", "仙人掌", "含羞草", "霸王花", "猪笼草", "流星雨", "龙卷风", "日全食",

            // --- 运动与乐器 ---
            "马拉松", "举重", "撑杆跳", "花样滑冰", "相扑", "拳击", "柔道", "击剑", "冲浪", "蹦极", "攀岩", "滑板", "尤克里里", "萨克斯", "竖琴", "风琴", "架子鼓", "快板", "口琴", "唢呐",

            // --- 职业与身份 ---
            "拆弹专家", "保镖", "保姆", "包工头", "包租婆", "乞丐", "侦探", "模特", "网红", "理发师", "救生员", "宇航员", "飞行员", "快递员", "外卖小哥", "程序员", "厨师", "魔术师", "小丑",

            // --- 更多成语与四字词 ---
            "一针见血", "三头六臂", "四面楚歌", "五光十色", "六神无主", "七嘴八舌", "八仙过海", "九死一生", "十全十美", "百里挑一", "千变万化", "万紫千红", "对牛弹琴", "狐假虎威", "守株待兔", "拔苗助长", "刻舟求剑", "井底之蛙",

            // --- 大马/随机混搭 ---
            "班兰叶", "煎蕊", "曼煎粿", "芙蓉烧包", "咸鱼", "江鱼仔", "山竹", "红毛丹", "波罗蜜", "炸香蕉", "美禄恐龙", "虎咬狮", "苏丹鱼", "苏丹王", "拿督", "打小人", "接机", "迷路", "碰瓷", "刷卡", "零钱", "存钱罐"
        ];

        let usedWords = []; 
        let selected = [], scoreA = 0, scoreB = 0, changeCount = 0, currentTurn = 'A';
        let timer, timeLeft = 60, targetScore = 10, isTimerRunning = false;

        const speak = (msg) => {
            window.speechSynthesis.cancel();
            const u = new SpeechSynthesisUtterance(msg);
            u.lang = 'zh-CN'; u.rate = 1.0;
            window.speechSynthesis.speak(u);
        };

        const teams = [
            { name: '守银队', bg: '#94a3b8', text: '#000000' }, { name: '娟金队', bg: '#fbbf24', text: '#000000' },
            { name: '极白队', bg: '#ffffff', text: '#000000' }, { name: '绸黑队', bg: '#000000', text: '#ffffff' },
            { name: '绿奇队', bg: '#22c55e', text: '#000000' }, { name: '寒蓝队', bg: '#3b82f6', text: '#ffffff' },
            { name: '绍黄队', bg: '#eab308', text: '#000000' }, { name: '棕紫队', bg: '#a855f7', text: '#ffffff' }
        ];

        function unlockAndPlay() {
            speak("年年有愚, fool 星高照, 游戏开始，请选你的队队!");
            document.getElementById('gate-screen').classList.add('hidden');
            document.getElementById('setup-screen').classList.remove('hidden');
            renderTeams();
        }

        function renderTeams() {
            const container = document.getElementById('team-selector');
            container.innerHTML = '';
            teams.forEach(t => {
                const btn = document.createElement('button');
                btn.innerText = t.name;
                btn.className = "py-4 rounded-2xl font-black text-lg border-4 border-transparent transition-all active:scale-95 shadow-lg bg-slate-800";
                btn.style.backgroundColor = t.bg; btn.style.color = t.text;
                btn.onclick = () => {
                    const idx = selected.findIndex(s => s.name === t.name);
                    if(idx > -1) { 
                        selected.splice(idx, 1); 
                        btn.classList.remove('team-btn-selected'); 
                    } else if(selected.length < 2) { 
                        selected.push(t); 
                        btn.classList.add('team-btn-selected'); 
                        speak(t.name); 
                    }
                };
                container.appendChild(btn);
            });
        }

        function confirmTeams() {
            if(selected.length < 2) return alert("选两队先啦!");
            speak("开战罗!");
            targetScore = parseInt(document.getElementById('target-slider').value);
            document.getElementById('labelA').innerText = selected[0].name;
            document.getElementById('labelB').innerText = selected[1].name;
            document.getElementById('ui-teamA').style.color = selected[0].bg;
            document.getElementById('ui-teamB').style.color = selected[1].bg;
            document.getElementById('setup-screen').classList.add('hidden');
            document.getElementById('game-screen').classList.remove('hidden');
            updateTurnUI();
        }

        function updateTurnUI() {
            const a = document.getElementById('ui-teamA'), b = document.getElementById('ui-teamB');
            if(currentTurn === 'A') { a.classList.add('active-team-glow'); b.classList.remove('active-team-glow'); }
            else { b.classList.add('active-team-glow'); a.classList.remove('active-team-glow'); }
        }

        function getRandomWord() {
            if (usedWords.length >= allWords.length) usedWords = []; 
            let availableWords = allWords.filter(w => !usedWords.includes(w));
            let pick = availableWords[Math.floor(Math.random() * availableWords.length)];
            usedWords.push(pick);
            return pick;
        }

        function drawWord() {
            document.getElementById('word-display').innerText = getRandomWord();
            document.getElementById('btn-draw').classList.add('hidden');
            document.getElementById('change-confirm-group').classList.remove('hidden');
            changeCount = 0;
            document.getElementById('btn-change').innerText = `换题 (剩 2 次)`;
            document.getElementById('btn-change').classList.remove('opacity-40');
        }

        function changeWord() {
            if(changeCount >= 2) { speak("这条水没有文 fak"); return; }
            changeCount++;
            speak("这条水没有文 fak, 换题第" + changeCount + "次");
            document.getElementById('word-display').innerText = getRandomWord();
            document.getElementById('btn-change').innerText = `换题 (剩 ${2 - changeCount} 次)`;
            if(changeCount >= 2) document.getElementById('btn-change').classList.add('opacity-40');
        }

        function confirmAndStart() {
            speak("计时开始");
            document.getElementById('pre-game-controls').classList.add('hidden');
            document.getElementById('active-game-controls').classList.remove('hidden');
            document.getElementById('word-display').classList.add('hidden-word');
            document.getElementById('hint-text').style.opacity = "1";
            startTimer();
        }

        function startTimer() {
            clearInterval(timer); timeLeft = 60; isTimerRunning = true;
            document.getElementById('timer').innerText = "60s";
            timer = setInterval(() => {
                timeLeft--;
                document.getElementById('timer').innerText = timeLeft + "s";
                if(timeLeft <= 5 && timeLeft > 0) { 
                    document.getElementById('flash-overlay').classList.add('emergency-active');
                    speak(timeLeft.toString()); 
                }
                if(timeLeft <= 0) {
                    clearInterval(timer); isTimerRunning = false;
                    document.getElementById('flash-overlay').classList.remove('emergency-active');
                    document.getElementById('word-display').classList.remove('hidden-word');
                    document.getElementById('word-display').classList.add('reveal-answer');
                    speak("时间到! 谜底是 " + document.getElementById('word-display').innerText + ", Delay no more");
                    setTimeout(handleSwitch, 4000); 
                }
            }, 1000);
        }

        const card = document.getElementById('card-area'), display = document.getElementById('word-display');
        const handlePeek = () => { if(isTimerRunning) display.classList.add('peek-word'); };
        const handleUnpeek = () => { display.classList.remove('peek-word'); };
        card.addEventListener('touchstart', (e) => { e.preventDefault(); handlePeek(); });
        card.addEventListener('touchend', handleUnpeek);
        card.addEventListener('mousedown', handlePeek);
        card.addEventListener('mouseup', handleUnpeek);

        function handlePoint() {
            if(!isTimerRunning && timeLeft > 0) return;
            clearInterval(timer); isTimerRunning = false;
            document.getElementById('flash-overlay').classList.remove('emergency-active');
            confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 } });
            if(currentTurn === 'A') { scoreA++; document.getElementById('scoreA').innerText = scoreA; }
            else { scoreB++; document.getElementById('scoreB').innerText = scoreB; }
            speak("答对鸟! 加一分!"); 
            checkWin(); resetRound();
        }

        function handleSwitch() {
            clearInterval(timer); isTimerRunning = false;
            const overlay = document.getElementById('flash-overlay');
            overlay.classList.add('emergency-active');
            setTimeout(() => overlay.classList.remove('emergency-active'), 1000);

            speak("哈哈哈, 你们没有度书的是不是?");
            currentTurn = currentTurn === 'A' ? 'B' : 'A';
            updateTurnUI(); resetRound();
        }

        function resetRound() {
            document.getElementById('pre-game-controls').classList.remove('hidden');
            document.getElementById('active-game-controls').classList.add('hidden');
            document.getElementById('btn-draw').classList.remove('hidden');
            document.getElementById('change-confirm-group').classList.add('hidden');
            document.getElementById('word-display').className = "text-5xl font-black text-slate-800 transition-all duration-300";
            document.getElementById('word-display').innerText = "READY?";
            document.getElementById('hint-text').style.opacity = "0";
            document.getElementById('timer').innerText = "60s";
        }

        function checkWin() {
            if(scoreA >= targetScore || scoreB >= targetScore) {
                const winner = scoreA >= targetScore ? selected[0].name : selected[1].name;
                confetti({ particleCount: 600, spread: 160, origin: { y: 0.6 } });
                speak("兴旺发! " + winner + " 赢了! 啪啪啪啪啪");
                setTimeout(() => location.reload(), 8000);
            }
        }
    </script>
</body>
</html>
