<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>年年有愚 FOOL星高照</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        body {
            background-color: #020617;
            background-image: radial-gradient(circle at 20% 30%, rgba(220, 38, 38, 0.1) 0%, transparent 50%),
                              radial-gradient(circle at 80% 70%, rgba(220, 38, 38, 0.1) 0%, transparent 50%);
            position: relative;
            height: 100vh;
            overflow: hidden;
        }
        body::before {
            content: "";
            position: fixed; inset: 0;
            opacity: 0.05;
            pointer-events: none;
            background-image: url("data:image/svg+xml,%3Csvg width='100' height='60' viewBox='0 0 100 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M30 30c0-11 9-20 20-20s20 9 20 20h-5c0-8-7-15-15-15s-15 7-15 15h-5z' fill='%23ffffff' fill-rule='evenodd'/%3E%3C/svg%3E");
            z-index: 0;
        }

        .screen-layer {
            position: fixed;
            inset: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 100;
            background-color: #020617;
        }

        @keyframes char-bounce {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); color: #fbbf24; text-shadow: 0 0 15px #ef4444; }
        }
        .title-char { display: inline-block; animation: char-bounce 2s infinite; }
        .char-1 { animation-delay: 0.1s; } .char-2 { animation-delay: 0.3s; } .char-3 { animation-delay: 0.5s; } .char-4 { animation-delay: 0.7s; }

        .team-btn-selected { 
            border: 4px solid #ffffff !important;
            box-shadow: 0 0 30px currentColor !important;
            transform: scale(1.08);
            z-index: 10;
        }

        .active-team-glow { 
            animation: team-pulse 1.5s infinite alternate;
            border: 4px solid #ffffff !important;
        }
        @keyframes team-pulse {
            from { box-shadow: 0 0 5px currentColor; }
            to { box-shadow: 0 0 30px currentColor; }
        }

        .hidden-word { color: transparent !important; text-shadow: 0 0 40px rgba(0,0,0,1); user-select: none; }
        .peek-word { color: #1e293b !important; text-shadow: none !important; }
        .reveal-answer { color: #dc2626 !important; text-shadow: none !important; transform: scale(1.1); transition: all 0.3s; }
        
        @keyframes pulse-effect { 
            0% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.7); } 
            70% { box-shadow: 0 0 0 20px rgba(239, 68, 68, 0); } 
            100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0); } 
        }
        .pulse-btn { animation: pulse-effect 1.5s infinite; }

        @keyframes emergency-flash { 
            0%, 100% { background-color: transparent; } 
            50% { background-color: rgba(153, 27, 27, 0.7); } 
        }
        .emergency-active { animation: emergency-flash 0.4s infinite; }

        .start-btn { animation: pulse-effect 1.5s infinite; background: radial-gradient(circle, #facc15, #ea580c); }

        * { -webkit-touch-callout: none; -webkit-user-select: none; }
    </style>
</head>
<body class="flex flex-col items-center justify-center min-h-screen text-white font-sans">

    <div id="flash-overlay" class="fixed inset-0 pointer-events-none z-[200]"></div>

    <div id="gate-screen" class="screen-layer p-6 text-center">
        <h1 class="text-6xl font-black mb-12 italic tracking-tighter">
            <span class="text-red-500">年年</span><span class="text-amber-400">有愚</span>
        </h1>
        <button onclick="unlockAndPlay()" class="start-btn w-64 h-64 rounded-full text-slate-900 font-black text-4xl shadow-2xl border-4 border-amber-200">
            柑，你拿
        </button>
        <p class="mt-8 text-amber-200/60 font-bold tracking-widest uppercase">FOOL星高照</p>
    </div>

    <div id="setup-screen" class="screen-layer p-6 hidden">
        <div class="mb-2">
            <span class="title-char char-1 text-5xl font-black">年</span>
            <span class="title-char char-2 text-5xl font-black">年</span>
            <span class="title-char char-3 text-5xl font-black">有</span>
            <span class="title-char char-4 text-5xl font-black">愚</span>
        </div>
        <p class="text-amber-400 font-black tracking-[0.5em] mb-8">FOOL星高照</p>

        <div class="w-full max-w-md space-y-6">
            <div class="grid grid-cols-2 gap-4" id="team-selector"></div>
            <div class="bg-slate-800/90 p-5 rounded-3xl border border-red-900/50 text-center">
                <p class="mb-3 font-bold text-amber-100 italic">目标分数: <span id="target-display" class="text-2xl text-yellow-400">10</span></p>
                <input type="range" min="5" max="15" value="10" id="target-slider" oninput="document.getElementById('target-display').innerText=this.value" class="w-full h-3 bg-slate-700 rounded-lg appearance-none accent-red-500">
            </div>
            <button onclick="confirmTeams()" class="pulse-btn w-full bg-red-600 text-white font-black py-5 rounded-2xl text-3xl shadow-xl border-b-8 border-red-800 active:border-0 active:translate-y-1">开战咯！</button>
        </div>
    </div>

    <div id="game-screen" class="fixed inset-0 flex flex-col items-center justify-center p-4 hidden z-10 bg-transparent">
        <div class="w-full max-w-sm flex justify-between mb-6 gap-3">
            <div id="ui-teamA" class="p-4 rounded-[2rem] text-center w-[48%] transition-all border-4 border-transparent bg-slate-800/90 shadow-lg">
                <p id="labelA" class="text-[14px] font-black opacity-90 truncate">Team A</p>
                <p id="scoreA" class="text-5xl font-black">0</p>
            </div>
            <div id="ui-teamB" class="p-4 rounded-[2rem] text-center w-[48%] transition-all border-4 border-transparent bg-slate-800/90 shadow-lg">
                <p id="labelB" class="text-[14px] font-black opacity-90 truncate">Team B</p>
                <p id="scoreB" class="text-5xl font-black">0</p>
            </div>
        </div>

        <div id="card-area" class="w-full max-w-sm bg-white rounded-[4rem] shadow-[0_20px_50px_rgba(220,38,38,0.4)] p-10 text-center relative h-80 flex flex-col items-center justify-center border-8 border-red-50">
            <div id="timer" class="absolute top-8 text-4xl font-mono text-slate-300 font-black italic">60s</div>
            <div id="word-display" class="text-5xl font-black text-slate-800">READY?</div>
            <div id="hint-text" class="absolute bottom-8 text-[11px] text-slate-400 font-bold opacity-0 transition-opacity">长按屏幕查看谜底</div>
        </div>

        <div class="w-full max-w-sm mt-10 space-y-4">
            <div id="pre-game-controls" class="space-y-4">
                <button id="btn-draw" onclick="drawWord()" class="pulse-btn w-full bg-red-600 text-yellow-300 font-black py-6 rounded-3xl text-3xl shadow-2xl border-b-8 border-red-800 active:border-0 active:translate-y-2">抽 题</button>
                <div id="change-confirm-group" class="hidden space-y-3">
                    <button id="btn-change" onclick="changeWord()" class="w-full bg-slate-800 text-amber-400 font-bold py-4 rounded-2xl border-2 border-slate-700">换题 (剩 2 次)</button>
                    <button onclick="confirmAndStart()" class="w-full bg-emerald-500 text-white font-black py-5 rounded-3xl text-2xl shadow-lg border-b-8 border-emerald-700 active:border-0 active:translate-y-1">开始计时</button>
                </div>
            </div>
            
            <div id="active-game-controls" class="grid grid-cols-2 gap-4 hidden">
                <button onclick="handlePoint()" class="bg-amber-400 text-slate-900 font-black py-6 rounded-3xl shadow-xl text-2xl border-b-8 border-amber-600 active:border-0 active:translate-y-1">+1 答对</button>
                <button onclick="handleSwitch()" class="bg-slate-700 text-white font-bold py-6 rounded-3xl shadow-lg border-b-8 border-slate-900 active:border-0 active:translate-y-1 uppercase text-[16px]">答错/抢答</button>
            </div>
        </div>
    </div>

    <script>
        const allWords = [
            // 热梗与网络词 (更广更杂)
            "科目三", "孤勇者", "显眼包", "社交恐惧", "凡尔赛", "原地去世", "绝绝子", "泰裤辣", "芭比Q", "躺平", "摸鱼", "破防", "挖呀挖", "精神内耗", "特种兵", "反向带货", "恋爱脑", "电子榨菜", "孔乙己", "泰山崩", "恐龙抗狼", "我没意见", "你是我的神",
            // 成语 (高频且难表演)
            "掩耳盗铃", "画蛇添足", "对牛弹琴", "闻鸡起舞", "指鹿为马", "守株待兔", "拔苗助长", "盲人摸象", "狼吞虎咽", "昂首挺胸", "呆若木鸡", "三心二意", "五体投地", "七上八下", "目瞪口呆", "垂头丧气", "手舞足蹈", "铁石心肠", "滥竽充数", "东施效颦", "亡羊补牢", "凿壁偷光", "卧薪尝胆",
            // 动作/生活琐事 (细节化)
            "求婚", "碰瓷", "挤痘痘", "洗剪吹", "切洋葱", "吃火锅", "蹦迪", "举重", "美甲", "砍价", "整容", "相亲", "大扫除", "洗碗", "大笑", "掏耳朵", "敷面膜", "梦游", "跳绳", "拉肚子", "刮胡子", "修水管", "割双眼皮", "拍蚊子", "跳肚皮舞", "耍双节棍", "喝苦茶", "穿秋裤", "挤地铁",
            // 动物/植物/自然
            "草泥马", "霸王龙", "哈士奇", "萤火虫", "食人鱼", "含羞草", "猪笼草", "仙人掌", "山竹", "红毛丹", "长颈鹿", "袋鼠", "企鹅", "火烈鸟", "树懒", "河马", "曼陀罗", "捕蝇草", "食人花", "变色龙", "大猩猩", "北极熊",
            // 乐器与艺术
            "萨克斯", "架子鼓", "二胡", "口琴", "古筝", "芭蕾舞", "指挥家", "魔术师", "街舞", "京剧", "变脸", "拉小提琴", "弹钢琴", "打太极", "钢管舞",
            // 职业与物品
            "宇航员", "外卖小哥", "保镖", "拆弹专家", "网红", "美人鱼", "僵尸", "间谍", "吸血鬼", "充电宝", "黑洞", "流星雨", "朋友圈", "比特币", "金字塔", "埃菲尔", "万里长城", "打字机", "显微镜", "灭火器", "跑步机", "救生圈", "ATM机",
            // 大马元素 (精简版)
            "猫山王", "肉骨茶", "椰浆饭", "拉茶", "大耳窿", "跳槽", "摇脚", "茨厂街", "云顶高原", "黑风洞", "兴旺发", "西北够力", "打包", "饮茶", "搞定", "麻吉", "打工仔", "拿督", "油炸鬼", "娘惹", "啰惹", "巴刹", "五脚基"
        ];

        let usedWords = []; 
        let selected = [], scoreA = 0, scoreB = 0, changeCount = 0, currentTurn = 'A';
        let timer, timeLeft = 60, targetScore = 10, isTimerRunning = false;

        const speak = (msg) => {
            window.speechSynthesis.cancel();
            const u = new SpeechSynthesisUtterance(msg);
            u.lang = 'zh-CN'; u.rate = 1.0;
            window.speechSynthesis.speak(u);
        };

        const teams = [
            { name: '守银队', bg: '#94a3b8', text: '#000000' }, { name: '娟金队', bg: '#fbbf24', text: '#000000' },
            { name: '极白队', bg: '#ffffff', text: '#000000' }, { name: '绸黑队', bg: '#000000', text: '#ffffff' },
            { name: '绿奇队', bg: '#22c55e', text: '#000000' }, { name: '寒蓝队', bg: '#3b82f6', text: '#ffffff' },
            { name: '绍黄队', bg: '#eab308', text: '#000000' }, { name: '棕紫队', bg: '#a855f7', text: '#ffffff' }
        ];

        function unlockAndPlay() {
            speak("年年有愚, fool 星高照, 游戏开始!");
            document.getElementById('gate-screen').classList.add('hidden');
            document.getElementById('setup-screen').classList.remove('hidden');
            renderTeams();
        }

        function renderTeams() {
            const container = document.getElementById('team-selector');
            container.innerHTML = '';
            teams.forEach(t => {
                const btn = document.createElement('button');
                btn.innerText = t.name;
                btn.className = "py-4 rounded-2xl font-black text-lg border-4 border-transparent transition-all active:scale-95 shadow-lg bg-slate-800";
                btn.style.backgroundColor = t.bg; btn.style.color = t.text;
                btn.onclick = () => {
                    const idx = selected.findIndex(s => s.name === t.name);
                    if(idx > -1) { selected.splice(idx, 1); btn.classList.remove('team-btn-selected'); }
                    else if(selected.length < 2) { selected.push(t); btn.classList.add('team-btn-selected'); speak(t.name); }
                };
                container.appendChild(btn);
            });
        }

        function confirmTeams() {
            if(selected.length < 2) return alert("选两队先啦!");
            speak("开战咯!");
            targetScore = parseInt(document.getElementById('target-slider').value);
            document.getElementById('labelA').innerText = selected[0].name;
            document.getElementById('labelB').innerText = selected[1].name;
            document.getElementById('ui-teamA').style.color = selected[0].bg;
            document.getElementById('ui-teamB').style.color = selected[1].bg;
            document.getElementById('setup-screen').classList.add('hidden');
            document.getElementById('game-screen').classList.remove('hidden');
            updateTurnUI();
        }

        function updateTurnUI() {
            const a = document.getElementById('ui-teamA'), b = document.getElementById('ui-teamB');
            if(currentTurn === 'A') { a.classList.add('active-team-glow'); b.classList.remove('active-team-glow'); }
            else { b.classList.add('active-team-glow'); a.classList.remove('active-team-glow'); }
        }

        function getRandomWord() {
            if (usedWords.length >= allWords.length) usedWords = []; 
            let availableWords = allWords.filter(w => !usedWords.includes(w));
            let pick = availableWords[Math.floor(Math.random() * availableWords.length)];
            usedWords.push(pick);
            return pick;
        }

        function drawWord() {
            document.getElementById('word-display').innerText = getRandomWord();
            document.getElementById('btn-draw').classList.add('hidden');
            document.getElementById('change-confirm-group').classList.remove('hidden');
            changeCount = 0;
            document.getElementById('btn-change').innerText = `换题 (剩 2 次)`;
            document.getElementById('btn-change').classList.remove('opacity-40');
        }

        function changeWord() {
            if(changeCount >= 2) { speak("这条水没有文 fak"); return; }
            changeCount++;
            speak("这条水没有文 fak, 换题第" + changeCount + "次");
            document.getElementById('word-display').innerText = getRandomWord();
            document.getElementById('btn-change').innerText = `换题 (剩 ${2 - changeCount} 次)`;
            if(changeCount >= 2) document.getElementById('btn-change').classList.add('opacity-40');
        }

        function confirmAndStart() {
            speak("计时开始");
            document.getElementById('pre-game-controls').classList.add('hidden');
            document.getElementById('active-game-controls').classList.remove('hidden');
            document.getElementById('word-display').classList.add('hidden-word');
            document.getElementById('hint-text').style.opacity = "1";
            startTimer();
        }

        function startTimer() {
            clearInterval(timer); timeLeft = 60; isTimerRunning = true;
            document.getElementById('timer').innerText = "60s";
            timer = setInterval(() => {
                timeLeft--;
                document.getElementById('timer').innerText = timeLeft + "s";
                if(timeLeft <= 5 && timeLeft > 0) { 
                    document.getElementById('flash-overlay').classList.add('emergency-active');
                    speak(timeLeft.toString()); 
                }
                if(timeLeft <= 0) {
                    clearInterval(timer); isTimerRunning = false;
                    document.getElementById('flash-overlay').classList.remove('emergency-active');
                    document.getElementById('word-display').classList.remove('hidden-word');
                    document.getElementById('word-display').classList.add('reveal-answer');
                    speak("时间到! 谜底是 " + document.getElementById('word-display').innerText + ", Delay no more");
                    setTimeout(handleSwitch, 4000); 
                }
            }, 1000);
        }

        const card = document.getElementById('card-area'), display = document.getElementById('word-display');
        const handlePeek = () => { if(isTimerRunning) display.classList.add('peek-word'); };
        const handleUnpeek = () => { display.classList.remove('peek-word'); };
        card.addEventListener('touchstart', (e) => { e.preventDefault(); handlePeek(); });
        card.addEventListener('touchend', handleUnpeek);
        card.addEventListener('mousedown', handlePeek);
        card.addEventListener('mouseup', handleUnpeek);

        function handlePoint() {
            if(!isTimerRunning && timeLeft > 0) return;
            clearInterval(timer); isTimerRunning = false;
            document.getElementById('flash-overlay').classList.remove('emergency-active');
            confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 } });
            if(currentTurn === 'A') { scoreA++; document.getElementById('scoreA').innerText = scoreA; }
            else { scoreB++; document.getElementById('scoreB').innerText = scoreB; }
            speak("答对鸟! 加一分!"); 
            checkWin(); resetRound();
        }

        function handleSwitch() {
            clearInterval(timer); isTimerRunning = false;
            const overlay = document.getElementById('flash-overlay');
            overlay.classList.add('emergency-active');
            setTimeout(() => overlay.classList.remove('emergency-active'), 1000);

            speak("哈哈哈, 你们没有度书的是不是?");
            currentTurn = currentTurn === 'A' ? 'B' : 'A';
            updateTurnUI(); resetRound();
        }

        function resetRound() {
            document.getElementById('pre-game-controls').classList.remove('hidden');
            document.getElementById('active-game-controls').classList.add('hidden');
            document.getElementById('btn-draw').classList.remove('hidden');
            document.getElementById('change-confirm-group').classList.add('hidden');
            document.getElementById('word-display').className = "text-5xl font-black text-slate-800 transition-all duration-300";
            document.getElementById('word-display').innerText = "READY?";
            document.getElementById('hint-text').style.opacity = "0";
            document.getElementById('timer').innerText = "60s";
        }

        function checkWin() {
            if(scoreA >= targetScore || scoreB >= targetScore) {
                const winner = scoreA >= targetScore ? selected[0].name : selected[1].name;
                confetti({ particleCount: 600, spread: 160, origin: { y: 0.6 } });
                speak("兴旺发! " + winner + " 赢了! 啪啪啪啪啪");
                setTimeout(() => location.reload(), 8000);
            }
        }
    </script>
</body>
</html>
